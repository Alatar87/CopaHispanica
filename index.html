<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Copa Hisp√°nica ¬∑ Torneo sancionado Blackout Rugby</title>
<meta name="description" content="Copa Hisp√°nica: torneo de managers Espa√±a en Blackout Rugby. Lunes ¬∑ Trofeos y Cuchara de Madera.">
<style>
:root{ --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e5e7eb; --accent:#60a5fa; --accent2:#a78bfa; --ok:#34d399; --warn:#f59e0b; }
*{box-sizing:border-box} html,body{margin:0;padding:0;background:linear-gradient(180deg,var(--bg),#0a0f1a 60%,#070b13);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif}
a{color:var(--accent)} .container{max-width:1100px;margin:0 auto;padding:24px}
header{position:sticky;top:0;z-index:10;backdrop-filter:saturate(170%) blur(8px);background:rgba(10,15,26,.8);border-bottom:1px solid rgba(255,255,255,.06)}
.nav{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:12px 24px}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:40px;height:40px;border-radius:10px;background:radial-gradient(circle at 30% 30%, var(--accent), var(--accent2));box-shadow:0 0 32px rgba(96,165,250,.4)}
.brand h1{font-size:1.1rem;margin:0;letter-spacing:.4px}
.menu{display:flex;gap:12px;flex-wrap:wrap}
.menu a{padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.06);text-decoration:none;color:var(--text);border:1px solid rgba(255,255,255,.08)}
.menu a:hover{background:rgba(255,255,255,.1)}
.hero{padding:60px 24px 24px}
.hero .wrap{display:grid;grid-template-columns:1.1fr .9fr;gap:24px}
.card{background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,.32);padding:20px}
.title{font-size:clamp(28px,3vw,42px);margin:0 0 6px}
.subtitle{margin:0;color:var(--muted)}
.pill{display:inline-block;margin-top:12px;padding:6px 10px;border-radius:999px;background:rgba(96,165,250,.15);border:1px solid rgba(96,165,250,.35);color:#cfe4ff;font-size:.9rem}
.grid{display:grid;gap:16px}
.grid.cols-2{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
.grid.cols-3{grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
h2{margin:0 0 10px;font-size:1.25rem}
.muted{color:var(--muted)}
.kpi{display:flex;gap:14px;align-items:center}
.kpi .num{font-weight:700;font-size:1.4rem}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,.07);text-align:left}
th{color:#cfe4ff;font-weight:600;background:rgba(255,255,255,.04)}
tr:hover td{background:rgba(255,255,255,.02)}
.badge{padding:3px 8px;border-radius:999px;font-size:.8rem;border:1px solid rgba(255,255,255,.2)}
.badge.ok{background:rgba(52,211,153,.1);border-color:rgba(52,211,153,.35)}
.badge.warn{background:rgba(245,158,11,.1);border-color:rgba(245,158,11,.35)}
.section{padding:24px}
.two-col{display:grid;grid-template-columns:2fr 1fr;gap:24px}
.note{background:rgba(96,165,250,.08);border:1px dashed rgba(96,165,250,.35);padding:12px;border-radius:12px}
.small{font-size:.92rem}
.footer{padding:24px;color:var(--muted);text-align:center}
@media (max-width: 900px){ .hero .wrap{grid-template-columns:1fr} .two-col{grid-template-columns:1fr} }
img.logo-br{display:block; max-height:40px; object-fit:contain}
</style>
</head>
<body>
<header>
  <nav class="nav container">
    <div class="brand"><div class="logo" aria-hidden="true"></div><h1>Copa Hisp√°nica</h1></div>
    <div class="menu">
      <a href="#info">Informaci√≥n</a><a href="#participantes">Participantes</a><a href="#calendario">Calendario</a>
      <a href="#clasificacion">Clasificaci√≥n</a><a href="#reglamento">Reglamento</a><a href="#br-terms">BR ¬∑ T√©rminos</a><a href="#contacto">Contacto</a>
    </div>
  </nav>
</header>

<main>
<section class="hero">
  <div class="container wrap">
    <div class="card">
      <p class="pill" id="editionPill">Edici√≥n 2025 ¬∑ Lunes</p>
      <h2 class="title">Copa Hisp√°nica</h2>
      <p class="subtitle">Torneo de managers con equipos activos en Espa√±a (Blackout Rugby). Trofeos a los primeros clasificados y <em>Cuchara de Madera</em> al √∫ltimo.</p>
      <div class="grid cols-3" style="margin-top:16px">
        <div class="kpi card"><div><div class="num" id="kpiEquipos">14</div><div class="muted">Equipos apuntados</div></div></div>
        <div class="kpi card"><div><div class="num" id="kpiObjetivo">24</div><div class="muted">Objetivo de equipos</div></div></div>
        <div class="kpi card"><div><div class="num">üèÜ</div><div class="muted">Trofeos + Cuchara</div></div></div>
      </div>
      <div class="note" style="margin-top:12px"><strong>Formato</strong>: seg√∫n inscritos (ideal: 24). Partidos los <strong>lunes</strong>. La web mostrar√° estructura, fixtures y resultados.</div>
      <div class="cta" style="margin-top:14px">
        <a class="badge warn" href="#participantes">Ver participantes</a>
        <a class="badge" href="https://www.blackoutrugby.com/home.php" target="_blank" rel="noopener">Blackout Rugby</a>
      </div>
    </div>
    <div class="card">
      <h2>Pr√≥ximos partidos</h2>
      <div id="proximos" class="muted">A√∫n no definidos</div>
      <hr style="border-color:rgba(255,255,255,.06);margin:16px 0">
      <h2>√öltimos resultados</h2>
      <ul id="ultimos" class="muted" style="padding-left:18px;margin:0"></ul>

      <div class="note small" style="margin-top:16px">
        <label><input type="checkbox" id="adminToggle"> Modo admin (local)</label>
        <div id="adminPanel" style="display:none; margin-top:8px">
          <div class="cta">
            <button id="btnExport">Descargar results.json</button>
            <button id="btnLoadRepo">Cargar results.json del repo</button>
          </div>
          <p class="small muted" style="margin:8px 0 4px">Pega JSON v√°lido para importar/editar:</p>
          <textarea id="jsonArea" rows="8" style="width:100%" placeholder='[{"jornada":1,"fecha":"2025-10-27 19:35","fase":"Grupos","local":"Equipo A","visitante":"Equipo B","pL":0,"pV":0,"tL":0,"tV":0,"estado":"pendiente"}]'></textarea>
          <div class="cta" style="margin-top:8px">
            <button id="btnImport">Importar JSON</button>
            <button id="btnGuardarLocal">Guardar en este navegador</button>
            <button id="btnReset">Vaciar</button>
          </div>
          <p class="small muted">S√∫belo como <code>results.json</code> en la ra√≠z del repo para que sea p√∫blico.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="info" class="section">
  <div class="container two-col">
    <div class="card">
      <h2>Informaci√≥n</h2>
      <p><strong>Post original</strong>: Recuperamos la <em>Copa Hisp√°nica</em>. Partidos los <strong>Lunes</strong>. Trofeos a los primeros clasificados y a la <em>Cuchara de Madera</em> (√∫ltimo clasificado). Formato definitivo en funci√≥n de inscripciones (ideal 24 equipos; actualmente 55 equipos activos en Espa√±a).</p>
    </div>
    <div class="card">
      <h2>Estado de inscripciones</h2>
      <p class="muted small">La lista puede crecer. Si quieres participar, contacta con la organizaci√≥n.</p>
    </div>
  </div>
</section>

<section id="participantes" class="section">
  <div class="container">
    <div class="card">
      <h2>Participantes actuales (14)</h2>
      <div id="listaEquipos" class="grid cols-2"></div>
    </div>
  </div>
</section>

<section id="calendario" class="section">
  <div class="container">
    <div class="card">
      <h2>Calendario</h2>
      <p class="muted small">Los partidos se importan de <code>results.json</code>.</p>
      <table id="tablaCal">
        <thead><tr><th>Jrn</th><th>Fecha</th><th>Fase</th><th>Partido</th><th>Marcador</th><th>Ensayos</th><th>Estado</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</section>

<section id="clasificacion" class="section">
  <div class="container">
    <div class="card">
      <h2>Clasificaci√≥n (din√°mica)</h2>
      <p class="muted small">Se calcula autom√°ticamente con los resultados cargados (4-2-0, bonus 4+ ensayos, bonus derrota ‚â§7).</p>
      <div id="tablaClasificacion" class="grid cols-2"></div>
    </div>
  </div>
</section>

<section id="reglamento" class="section">
  <div class="container">
    <div class="card">
      <h2>Reglamento (resumen)</h2>
      <ul>
        <li>Participan managers con equipos activos en Espa√±a (en BR) ‚Äî los equipos pueden jugar en cualquier pa√≠s.</li>
        <li>Formato: grupos + eliminatorias (o liga), definido seg√∫n inscritos. Partidos los <strong>lunes</strong>.</li>
        <li>Puntuaci√≥n: 4 victoria ¬∑ 2 empate ¬∑ 0 derrota ¬∑ +1 bonus por 4+ ensayos ¬∑ +1 bonus por perder por ‚â§7.</li>
        <li>Desempates: diferencia (PF‚àíPC) ‚Üí mayor PF ‚Üí menor PC ‚Üí bonus ensayos ‚Üí bonus derrota ‚Üí sorteo.</li>
        <li>Trofeos: campeones de cada cuadro y <em>Cuchara de Madera</em> al √∫ltimo.</li>
      </ul>
    </div>
  </div>
</section>

<section id="br-terms" class="section">
  <div class="container two-col">
    <div class="card">
      <h2>T√©rminos de Torneo Sancionado (Blackout Rugby)</h2>
      <p class="small muted">Resumen de las condiciones (ver texto completo en el panel del torneo):</p>
      <ol>
        <li>Web con estructura, fixtures al d√≠a y transparencia para monitorizaci√≥n.</li>
        <li>Usar el logotipo <strong>‚ÄúSanctioned Tournament‚Äù</strong> en todas las p√°ginas y enlazar a <a href="https://www.blackoutrugby.com/home.php" target="_blank" rel="noopener">https://www.blackoutrugby.com/home.php</a>.</li>
        <li>Recursos provistos por BR pueden usarse sin editar (salvo permiso); tambi√©n en trofeos/camisetas/documentos.</li>
        <li>Actuar de forma justa y √©tica; derecho a gestionar incidencias y rechazar participaci√≥n si procede.</li>
        <li>La competici√≥n debe representar positivamente a BR.</li>
        <li>BR puede pedir cambios o retirar accesos para proteger su reputaci√≥n.</li>
        <li>Reportar usos no autorizados de recursos de BR.</li>
        <li><em>Nuevo</em>: Garant√≠a de no infringir derechos de terceros; indemnizaci√≥n a Blackout por reclamaciones.</li>
      </ol>
      <p class="small">Coloca aqu√≠ el logo oficial ‚ÄúSanctioned Tournament‚Äù cuando lo tengas:</p>
      <img class="logo-br" src="sanctioned-logo.png" alt="Blackout Rugby ¬∑ Sanctioned Tournament (colocar asset oficial)">
    </div>
    <div class="card">
      <h2>Checklist de cumplimiento</h2>
      <ul>
        <li>‚úÖ Enlace visible a BR en la home.</li>
        <li>‚úÖ Estructura + fixtures actualizados.</li>
        <li>üü¶ A√±adir logo oficial ‚ÄúSanctioned Tournament‚Äù.</li>
        <li>üü¶ Subir y mantener <code>results.json</code>.</li>
      </ul>
    </div>
  </div>
</section>

<section id="contacto" class="section">
  <div class="container"><div class="card"><h2>Contacto</h2><p>Organizaci√≥n: <a href="mailto:organizacion@example.com">organizacion@example.com</a> ¬∑ Foro nacional de BR.</p></div></div>
</section>
</main>

<footer class="footer">¬© <span id="year"></span> Copa Hisp√°nica ¬∑ Torneo sancionado Blackout Rugby ¬∑ <a href="https://www.blackoutrugby.com/home.php" target="_blank" rel="noopener">Blackout Rugby</a></footer>

<script>
const PARTICIPANTES = [
  "Chamizos RC - 10800",
  "Gipuzkoa Errugbi - 82824",
  "Chamizos - 1558",
  "Sparta de Sibaris - 82920",
  "Amics de la Cervesa - 83075",
  "Molledo S.D. - 6378",
  "RIB - 82729",
  "CP Les Abelles - 82816",
  "Baskonia - 82595",
  "Subterranean Homesick Aliens - 79139",
  "C.R. Guindalera - 83261",
  "U.E Suburense - 82879",
  "Diogenes Club - 350",
  "Guardo Sharks - 40246"
];
const STATE = { partidos: [] };
const fmt = (s)=> s? new Date(s.replace(' ','T')+':00').toLocaleString('es-ES',{dateStyle:'medium', timeStyle:'short'}) : '‚Äî';
async function cargarResultados(){
  try{
    const res = await fetch('results.json', {cache:'no-store'});
    if(!res.ok) throw new Error('no results.json');
    const data = await res.json();
    if(Array.isArray(data)) STATE.partidos = data; else throw new Error('formato inv√°lido');
  }catch(e){
    const local = localStorage.getItem('hispanica_results');
    STATE.partidos = local ? JSON.parse(local) : [];
  }
}
function renderParticipantes(){
  const cont = document.getElementById('listaEquipos'); cont.innerHTML='';
  PARTICIPANTES.forEach((n,i)=>{
    const d = document.createElement('div'); d.className = 'card';
    d.innerHTML = `<strong>${String(i+1).padStart(2,'0')}.</strong> ${n}`;
    cont.appendChild(d);
  });
  document.getElementById('kpiEquipos').textContent = PARTICIPANTES.length;
}
function renderCalendario(){
  const tb = document.querySelector('#tablaCal tbody'); tb.innerHTML='';
  const rows = [...STATE.partidos].sort((a,b)=> (a.jornada??0)-(b.jornada??0));
  rows.forEach(r=>{
    const tr = document.createElement('tr');
    const marcador = (r.pL!=null && r.pV!=null) ? `${r.pL} ‚Äì ${r.pV}` : '‚Äî';
    const ensayos  = (r.tL!=null && r.tV!=null) ? `${r.tL} ‚Äì ${r.tV}` : '‚Äî';
    tr.innerHTML = `<td>${r.jornada??'‚Äî'}</td><td>${fmt(r.fecha)}</td><td>${r.fase||'‚Äî'}</td><td>${r.local||'‚Äî'} vs ${r.visitante||'‚Äî'}</td><td>${marcador}</td><td>${ensayos}</td><td>${r.estado||'pendiente'}</td>`;
    tb.appendChild(tr);
  });
}
function calcularClasificacion(){
  const equipos = new Set();
  STATE.partidos.forEach(p=>{ if(p.local) equipos.add(p.local); if(p.visitante) equipos.add(p.visitante); });
  const tabla = {};
  [...equipos].forEach(n=> tabla[n] = {Equipo:n,PJ:0,PG:0,PE:0,PP:0,PF:0,PC:0,PB_ens:0,PB_der:0,Pts:0,Diff:0});
  const jugados = STATE.partidos.filter(p=> p.estado==='finalizado' && p.pL!=null && p.pV!=null);
  jugados.forEach(p=>{
    const L = tabla[p.local]||(tabla[p.local]={Equipo:p.local,PJ:0,PG:0,PE:0,PP:0,PF:0,PC:0,PB_ens:0,PB_der:0,Pts:0,Diff:0});
    const V = tabla[p.visitante]||(tabla[p.visitante]={Equipo:p.visitante,PJ:0,PG:0,PE:0,PP:0,PF:0,PC:0,PB_ens:0,PB_der:0,Pts:0,Diff:0});
    L.PJ++; V.PJ++; L.PF+=p.pL; L.PC+=p.pV; V.PF+=p.pV; V.PC+=p.pL;
    if(p.pL>p.pV){ L.PG++; V.PP++; L.Pts+=4; }
    else if(p.pL<p.pV){ V.PG++; L.PP++; V.Pts+=4; }
    else { L.PE++; V.PE++; L.Pts+=2; V.Pts+=2; }
    if(typeof p.tL==='number' && p.tL>=4){ L.PB_ens++; L.Pts++; }
    if(typeof p.tV==='number' && p.tV>=4){ V.PB_ens++; V.Pts++; }
    const dif = Math.abs(p.pL - p.pV);
    if(p.pL<p.pV && dif<=7){ L.PB_der++; L.Pts++; }
    if(p.pV<p.pL && dif<=7){ V.PB_der++; V.Pts++; }
  });
  Object.values(tabla).forEach(r=> r.Diff = r.PF - r.PC);
  return Object.values(tabla).sort((a,b)=> b.Pts-a.Pts || b.Diff-a.Diff || b.PF-a.PF || a.PC-b.PC || b.PB_ens-a.PB_ens || b.PB_der-a.PB_der);
}
function renderClasificacion(){
  const wrap = document.getElementById('tablaClasificacion'); wrap.innerHTML='';
  const card = document.createElement('div'); card.className='card';
  const tbl = document.createElement('table');
  tbl.innerHTML = `<thead><tr><th>Pos</th><th>Equipo</th><th>PJ</th><th>PG</th><th>PE</th><th>PP</th><th>PF</th><th>PC</th><th>Diff</th><th>PB ens.</th><th>PB der.</th><th>Puntos</th></tr></thead>`;
  const tb = document.createElement('tbody');
  const data = calcularClasificacion();
  data.forEach((r,i)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${i+1}</td><td>${r.Equipo}</td><td>${r.PJ}</td><td>${r.PG}</td><td>${r.PE}</td><td>${r.PP}</td><td>${r.PF}</td><td>${r.PC}</td><td>${r.Diff}</td><td>${r.PB_ens}</td><td>${r.PB_der}</td><td><strong>${r.Pts}</strong></td>`;
    tb.appendChild(tr);
  });
  tbl.appendChild(tb); card.appendChild(tbl); wrap.appendChild(card);
}
function renderProximosYUltimos(){
  const futuros = STATE.partidos.filter(p=> p.estado!=='finalizado');
  const conFecha = futuros.filter(p=> p.fecha).map(p=> ({...p,cuando:new Date(p.fecha.replace(' ','T'))})).sort((a,b)=> a.cuando-b.cuando);
  const prox = conFecha[0] || futuros[0];
  const div = document.getElementById('proximos');
  if(prox){ div.innerHTML = `<strong>${prox.local||'‚Äî'}</strong> vs <strong>${prox.visitante||'‚Äî'}</strong> ¬∑ ${prox.fase||'‚Äî'} ¬∑ ${prox.fecha?fmt(prox.fecha):'Fecha por confirmar'}`; }
  const jugados = STATE.partidos.filter(p=> p.estado==='finalizado' && p.pL!=null && p.pV!=null)
    .sort((a,b)=> (b.jornada??0)-(a.jornada??0));
  const ul = document.getElementById('ultimos'); ul.innerHTML='';
  jugados.slice(0,5).forEach(p=>{
    const li = document.createElement('li');
    li.textContent = `${p.local} ${p.pL}-${p.pV} ${p.visitante} ¬∑ ${p.fase||'‚Äî'} ¬∑ ${p.fecha?fmt(p.fecha):'Fecha N/D'}`;
    ul.appendChild(li);
  });
}
function bindAdmin(){
  const toggle = document.getElementById('adminToggle');
  const panel = document.getElementById('adminPanel');
  toggle.addEventListener('change',()=> panel.style.display = toggle.checked ? 'block':'none');
  document.getElementById('btnExport').addEventListener('click',()=>{
    const blob = new Blob([JSON.stringify(STATE.partidos,null,2)],{type:'application/json'});
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'results.json'; a.click(); URL.revokeObjectURL(a.href);
  });
  document.getElementById('btnLoadRepo').addEventListener('click',async()=>{
    await cargarResultados(); (document.getElementById('jsonArea').value = JSON.stringify(STATE.partidos,null,2)); renderAll();
  });
  document.getElementById('btnImport').addEventListener('click',()=>{
    try{ const data = JSON.parse(document.getElementById('jsonArea').value);
      if(Array.isArray(data)){ STATE.partidos = data; renderAll(); alert('Datos importados'); }
      else alert('El JSON debe ser un array'); }catch(e){ alert('JSON inv√°lido'); }
  });
  document.getElementById('btnGuardarLocal').addEventListener('click',()=>{
    localStorage.setItem('hispanica_results', JSON.stringify(STATE.partidos)); alert('Guardado en este navegador.');
  });
  document.getElementById('btnReset').addEventListener('click',()=>{
    STATE.partidos = []; document.getElementById('jsonArea').value = '[]'; renderAll();
  });
}
function renderAll(){ renderParticipantes(); renderCalendario(); renderClasificacion(); renderProximosYUltimos(); }
(async function(){
  document.getElementById('year').textContent = new Date().getFullYear();
  await cargarResultados();
  bindAdmin();
  renderAll();
})();
</script>
</body>
</html>
